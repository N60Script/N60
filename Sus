-- // الخدمات
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")
local humanoid = character:WaitForChild("Humanoid")
local runService = game:GetService("RunService")

-- // GUI
local gui = Instance.new("ScreenGui")
gui.Name = "PDiddyGui"
gui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 150, 0, 120)
frame.Position = UDim2.new(0.4, 0, 0.3, 0)
frame.BackgroundColor3 = Color3.fromRGB(0,0,0)
frame.BorderSizePixel = 2
frame.BorderColor3 = Color3.fromRGB(255,0,0)
frame.Active = true
frame.Draggable = true
frame.Parent = gui

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,0,25)
title.BackgroundTransparency = 1
title.Text = "P Diddy Gui"
title.TextColor3 = Color3.fromRGB(255,0,0)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 18
title.Parent = frame

-- زر السكين
local button = Instance.new("TextButton")
button.Size = UDim2.new(1, -10, 0, 30)
button.Position = UDim2.new(0,5,0,35)
button.BackgroundColor3 = Color3.fromRGB(40,40,40)
button.TextColor3 = Color3.fromRGB(255,255,255)
button.Text = "زب"
button.Font = Enum.Font.SourceSansBold
button.TextSize = 16
button.Parent = frame

-- زر تغيير اللون
local colorButton = Instance.new("TextButton")
colorButton.Size = UDim2.new(1, -10, 0, 30)
colorButton.Position = UDim2.new(0,5,0,70)
colorButton.BackgroundColor3 = Color3.fromRGB(40,40,40)
colorButton.TextColor3 = Color3.fromRGB(255,255,255)
colorButton.Text = "تغيير اللون"
colorButton.Font = Enum.Font.SourceSansBold
colorButton.TextSize = 16
colorButton.Parent = frame

-- زر تحريك الشخصية
local moveButton = Instance.new("TextButton")
moveButton.Size = UDim2.new(1, -10, 0, 30)
moveButton.Position = UDim2.new(0,5,0,105)
moveButton.BackgroundColor3 = Color3.fromRGB(40,40,40)
moveButton.TextColor3 = Color3.fromRGB(255,255,255)
moveButton.Text = "ازغب"
moveButton.Font = Enum.Font.SourceSansBold
moveButton.TextSize = 16
moveButton.Parent = frame

-- متغير لتبديل اللون للسكين
local isBlack = true

-- متغير لحركة الشخصية
local moving = false

-- // وظيفة زر السكين
button.MouseButton1Click:Connect(function()
	if not character:FindFirstChild("KnifePart") then
		local torso = character:FindFirstChild("LowerTorso") or hrp

		local knife = Instance.new("Part")
		knife.Name = "KnifePart"
		knife.Size = Vector3.new(2, 0.5, 8)
		knife.Color = Color3.fromRGB(0,0,0)
		knife.Material = Enum.Material.Metal
		knife.Anchored = false
		knife.CanCollide = false
		knife.Shape = Enum.PartType.Cylinder
		knife.CFrame = torso.CFrame * CFrame.new(0, 0, -1.5) * CFrame.Angles(math.rad(90), 0, math.rad(90))
		knife.LocalTransparencyModifier = 0 -- يظهر في المنظور الأول
		local weld = Instance.new("WeldConstraint")
		weld.Part0 = torso
		weld.Part1 = knife
		weld.Parent = knife
		knife.Parent = character

		-- الكرة الورديّة أمام البطن
		local ball = Instance.new("Part")
		ball.Name = "KnifeBall"
		ball.Size = Vector3.new(0.8,0.8,0.8) -- أصغر قليلاً
		ball.Shape = Enum.PartType.Ball
		ball.Color = Color3.fromRGB(200,0,100)
		ball.Material = Enum.Material.Neon
		ball.Anchored = false
		ball.CanCollide = false
		ball.LocalTransparencyModifier = 0 -- يظهر في المنظور الأول
		ball.CFrame = torso.CFrame * CFrame.new(0, 0, -2)
		local ballWeld = Instance.new("WeldConstraint")
		ballWeld.Part0 = torso
		ballWeld.Part1 = ball
		ballWeld.Parent = ball
		ball.Parent = character

		-- كورتين بجانب البطن
		local leftBall = Instance.new("Part")
		leftBall.Name = "LeftBall"
		leftBall.Size = Vector3.new(1,1,1)
		leftBall.Shape = Enum.PartType.Ball
		leftBall.Color = Color3.fromRGB(0,0,0)
		leftBall.Material = Enum.Material.Metal
		leftBall.Anchored = false
		leftBall.CanCollide = false
		leftBall.LocalTransparencyModifier = 0 -- يظهر في المنظور الأول
		leftBall.CFrame = torso.CFrame * CFrame.new(-0.35, -0.2, -0.5)
		local weldL = Instance.new("WeldConstraint")
		weldL.Part0 = torso
		weldL.Part1 = leftBall
		weldL.Parent = leftBall
		leftBall.Parent = character

		local rightBall = Instance.new("Part")
		rightBall.Name = "RightBall"
		rightBall.Size = Vector3.new(1,1,1)
		rightBall.Shape = Enum.PartType.Ball
		rightBall.Color = Color3.fromRGB(0,0,0)
		rightBall.Material = Enum.Material.Metal
		rightBall.Anchored = false
		rightBall.CanCollide = false
		rightBall.LocalTransparencyModifier = 0 -- يظهر في المنظور الأول
		rightBall.CFrame = torso.CFrame * CFrame.new(0.35, -0.2, -0.5)
		local weldR = Instance.new("WeldConstraint")
		weldR.Part0 = torso
		weldR.Part1 = rightBall
		weldR.Parent = rightBall
		rightBall.Parent = character
	end
end)

-- // وظيفة زر تغيير اللون
colorButton.MouseButton1Click:Connect(function()
	local knife = character:FindFirstChild("KnifePart")
	local leftBall = character:FindFirstChild("LeftBall")
	local rightBall = character:FindFirstChild("RightBall")
	if knife and leftBall and rightBall then
		if isBlack then
			knife.Color = Color3.fromRGB(101,67,33)
			leftBall.Color = Color3.fromRGB(101,67,33)
			rightBall.Color = Color3.fromRGB(101,67,33)
			isBlack = false
		else
			knife.Color = Color3.fromRGB(0,0,0)
			leftBall.Color = Color3.fromRGB(0,0,0)
			rightBall.Color = Color3.fromRGB(0,0,0)
			isBlack = true
		end
	end
end)

-- // وظيفة زر تحريك الشخصية (On/Off)
moveButton.MouseButton1Click:Connect(function()
	moving = not moving
end)

-- تحديث حركة الشخصية كل إطار (VFly خفيف جدًا، أقل من السابق)
runService.RenderStepped:Connect(function()
	if moving then
		local offset = math.sin(tick()*6)*0.03 -- حركة أقل أمام
		local lookVector = hrp.CFrame.LookVector
		hrp.CFrame = hrp.CFrame + lookVector * offset
	end
end)
